(this["webpackJsonppi-home-web"]=this["webpackJsonppi-home-web"]||[]).push([[0],{175:function(e,t,a){e.exports=a(220)},180:function(e,t,a){},216:function(e,t){},220:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),c=a(9),l=a.n(c),o=(a(180),a(38)),i=a(12),s=a(159),u=a.n(s),m=a(160),p=a.n(m),d=a(161),b=a.n(d),f=a(162),v=a.n(f),E=a(35),h=a(13),g=a(281),O=a(296),j=a(280),w=a(94),x=a.n(w),k=a(292);function S(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;t&&window.localStorage.setItem(e,t);var a=function(t){window.localStorage.setItem(e,t)};return[window.localStorage.getItem(e),a]}var y,N=a(122),C=a.n(N),B=a(148),F=a(269),L=a(297),U=a(149),P=a.n(U),I=a(274),W=a(275),T=a(276),z=a(278),A=a(277),D=a(273),R=a(88),H=a(151),q=a.n(H),G=a(150),J=a.n(G),M=Object(F.a)((function(e){return Object(L.a)({root:{flexGrow:1},card:{textAlign:"center",color:e.palette.text.secondary},cardActions:{height:50},cardActionsRoot:{padding:8,display:"inline-flex"},media:{height:140,width:140,display:"block",margin:"auto"},actionItem:{display:"inline-block"},link:{textDecoration:"none",color:P.a[500]}})})),$=function(e){var t=e.device,a=M(),c=Object(n.useState)(t.status),l=Object(h.a)(c,2),i=l[0],s=l[1],u=S("serverBaseUrl"),m=Object(h.a)(u,1)[0];i!==t.status&&s(t.status);var p=function(){var e=Object(B.a)(C.a.mark((function e(a){var n,r,c;return C.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i!==a){e.next=9;break}return e.next=3,fetch("".concat(m,"/api/devices/change-status"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({pin:t.pin})});case 3:return n=e.sent,e.next=6,n.json();case 6:r=e.sent,c=r.status,s(c);case 9:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),d=null,b={fontSize:125},f=null;return"led"===t.type?(i&&(b=Object(E.a)(Object(E.a)({},b),{},{fill:"#ffef62"})),d=r.a.createElement(J.a,{style:b}),f=r.a.createElement(r.a.Fragment,null,r.a.createElement(D.a,{size:"small",color:"primary",className:a.actionItem,onClick:function(){return p(i||0)}},i?"Turn Off":"Turn On"))):t.type.toLowerCase().endsWith("button")&&(d=r.a.createElement(q.a,{style:Object(E.a)(Object(E.a)({},b),{},{fill:"#2a3eb1"})})),r.a.createElement(I.a,{item:!0,lg:3,md:4,xs:6},r.a.createElement(W.a,{className:a.card},r.a.createElement(T.a,null,r.a.createElement(o.b,{to:"/devices/view/".concat(t.pin),className:a.link},d),r.a.createElement(A.a,null,r.a.createElement(R.a,{gutterBottom:!0,variant:"h5",component:"h2"},t.label))),r.a.createElement(z.a,{className:a.cardActions,classes:{root:a.cardActionsRoot}},f)))},V=function(e){var t=e.devices,a=M();return r.a.createElement("div",{className:a.root},r.a.createElement(I.a,{container:!0,spacing:3},t&&t.map((function(e){return r.a.createElement($,{key:e.pin,device:e})}))))},K=a(152),Q=a.n(K),X=function(e){y=Q()(e)},Y=function(){y&&y.disconnect()},Z=function(e,t){y&&y.on(e,(function(a,n){n?t(a,n):t(e,a)}))},_=function(){var e=S("serverBaseUrl"),t=Object(h.a)(e,1)[0],a=Object(n.useState)(null),c=Object(h.a)(a,2),l=c[0],o=c[1],i=Object(n.useState)(null),s=Object(h.a)(i,2),u=s[0],m=s[1],p=Object(n.useState)(null),d=Object(h.a)(p,2),b=d[0],f=d[1],v=Object(n.useState)(!1),w=Object(h.a)(v,2),y=w[0],N=w[1],C=Object(n.useCallback)((function(){o(null),N(!0),fetch("".concat(t,"/api/devices")).then((function(e){return e.json()})).then((function(e){m(e),N(!1)})).catch((function(e){f(e),N(!1)}))}),[t]);Object(n.useEffect)((function(){return C(),t&&(X("".concat(t)),Z("all",(function(e,t){return o({eventName:e,data:t})}))),function(){Y()}}),[C,t]);var B=function(e,t){"clickaway"!==t&&f(null)};if(l&&u)switch(l.eventName){case"deviceStatusChanged":var F=u.map((function(e){return e.pin===l.data.pin?Object(E.a)(Object(E.a)({},e),{},{status:l.data.status}):e}));m(F),o(null)}return r.a.createElement(r.a.Fragment,null,b&&r.a.createElement(O.a,{open:!0,anchorOrigin:{vertical:"bottom",horizontal:"left"},autoHideDuration:6e3,onClose:B,action:r.a.createElement(n.Fragment,null,r.a.createElement(j.a,{size:"small","aria-label":"close",color:"inherit",onClick:B},r.a.createElement(x.a,{fontSize:"small"})))},r.a.createElement(k.a,{onClose:B,severity:"error",elevation:6,variant:"filled"},"".concat(b))),!b&&y?r.a.createElement(g.a,null):r.a.createElement(V,{devices:u}))},ee=function(){return r.a.createElement(r.a.Fragment,null,"add device")},te=function(){return r.a.createElement(r.a.Fragment,null,"edit device")},ae=function(){return r.a.createElement(r.a.Fragment,null,"view device")},ne=function(){return r.a.createElement(r.a.Fragment,null,"not found page")},re=a(43),ce=a(158),le=a.n(ce),oe=a(109),ie=a(108),se=a(3),ue=a(126),me=a(164),pe=a(291),de=a(283),be=a(157),fe=a.n(be),ve=Object(F.a)((function(e){return Object(L.a)({errorIcon:{color:"#ff1818"}})})),Ee=function(e){var t=e.className,a=e.error,n=e.inputProps,c=void 0===n?{}:n,l=e.variant,o=void 0===l?"filled":l,i=Object(me.a)(e,["className","error","inputProps","variant"]),s=ve();return r.a.createElement(pe.a,Object.assign({"data-id":"custom-input"},i,{className:t,variant:o,fullWidth:!0,margin:"dense",error:!!a,helperText:a,inputProps:{maxLength:c.maxLength},InputProps:{endAdornment:a&&r.a.createElement(de.a,{position:"end"},r.a.createElement(fe.a,{className:s.errorIcon}))}}))},he=Object(F.a)((function(e){return Object(L.a)({wrapper:{margin:e.spacing(1),position:"relative"},buttonSuccess:{backgroundColor:ie.a[500],"&:hover":{backgroundColor:ie.a[700]}},buttonProgress:{color:ie.a[500]}})})),ge=ue.a().shape({serverBaseUrl:ue.b().test({name:"serverBaseUrl",message:"${path} must be a valid URL",test:function(e){try{if(e)return new URL(e).protocol.startsWith("http")}catch(t){}return!1}}).required("Required")}),Oe=function(){var e=he(),t=S("serverBaseUrl"),a=Object(h.a)(t,2),n=a[0],c=a[1];return r.a.createElement(r.a.Fragment,null,r.a.createElement(R.a,{variant:"h5",noWrap:!0},"Server Settings"),r.a.createElement(oe.c,{initialValues:{serverBaseUrl:n||""},validationSchema:ge,onSubmit:function(e,t){var a=t.setSubmitting;(0,t.setStatus)(!0),setTimeout((function(){c(e.serverBaseUrl),a(!1)}),500)}},(function(t){var a=t.isSubmitting,n=t.status,c=Object(se.a)(Object(re.a)({},e.buttonSuccess,n)),l="Save";return a?l=r.a.createElement(g.a,{size:24,className:e.buttonProgress}):n&&(l=r.a.createElement(le.a,null)),r.a.createElement(oe.b,null,r.a.createElement(oe.a,{name:"serverBaseUrl"},(function(e){var t=e.field,a=e.meta.error;return r.a.createElement(Ee,Object.assign({label:"Server Base Url",error:a},t,{required:!0}))})),r.a.createElement("div",{className:e.wrapper},r.a.createElement(D.a,{variant:"contained",color:"primary",type:"submit",className:c,disabled:a},l)))})))},je=Object(F.a)((function(e){return Object(L.a)({root:{padding:e.spacing(3)},logo:{display:"block",margin:"auto"},text:{textAlign:"center",color:"black"}})})),we=function(){var e=je();return r.a.createElement("div",{className:e.root},r.a.createElement("img",{alt:"Pi Home",className:e.logo,src:"".concat("/pi-home-web","/images/icons/icon-96x96.png")}),r.a.createElement(R.a,{variant:"h5",className:e.text,noWrap:!0},"Pi Home"))},xe=Object(F.a)((function(e){return Object(L.a)({link:{textDecoration:"none"},text:{textAlign:"center",color:"black"},disclamer:{marginTop:50}})})),ke=[{path:"/",label:"Home",exact:!0,icon:u.a,component:function(){var e=S("serverBaseUrl"),t=Object(h.a)(e,1)[0],a=Object(n.useState)(null),c=Object(h.a)(a,2),l=c[0],o=c[1],i=Object(n.useState)(null),s=Object(h.a)(i,2),u=s[0],m=s[1],p=Object(n.useState)(null),d=Object(h.a)(p,2),b=d[0],f=d[1],v=Object(n.useState)(!1),w=Object(h.a)(v,2),y=w[0],N=w[1],C=Object(n.useCallback)((function(){o(null),N(!0),fetch("".concat(t,"/api/devices?type=led")).then((function(e){return e.json()})).then((function(e){m(e),N(!1)})).catch((function(e){f(e),N(!1)}))}),[t]);Object(n.useEffect)((function(){return C(),t&&(X("".concat(t)),Z("all",(function(e,t){return o({eventName:e,data:t})}))),function(){Y()}}),[C,t]);var B=function(e,t){"clickaway"!==t&&f(null)};if(l&&u)switch(l.eventName){case"deviceStatusChanged":var F=u.map((function(e){return e.pin===l.data.pin?Object(E.a)(Object(E.a)({},e),{},{status:l.data.status}):e}));m(F),o(null)}return r.a.createElement(r.a.Fragment,null,b&&r.a.createElement(O.a,{open:!0,anchorOrigin:{vertical:"bottom",horizontal:"left"},autoHideDuration:6e3,onClose:B,action:r.a.createElement(n.Fragment,null,r.a.createElement(j.a,{size:"small","aria-label":"close",color:"inherit",onClick:B},r.a.createElement(x.a,{fontSize:"small"})))},r.a.createElement(k.a,{onClose:B,severity:"error",elevation:6,variant:"filled"},"".concat(b))),!b&&y?r.a.createElement(g.a,null):r.a.createElement(V,{devices:u}))},sidebar:!0},{path:"/devices",label:"Devices",divider:!0,icon:p.a,component:function(){var e=Object(i.h)().path,t=S("serverBaseUrl");return Object(h.a)(t,1)[0]?r.a.createElement(r.a.Fragment,null,r.a.createElement(i.d,null,r.a.createElement(i.b,{exact:!0,path:e,component:_}),r.a.createElement(i.b,{exact:!0,path:"".concat(e,"/add"),component:ee}),r.a.createElement(i.b,{exact:!0,path:"".concat(e,"/view/:id(\\d+)"),component:ae}),r.a.createElement(i.b,{exact:!0,path:"".concat(e,"/edit/:id(\\d+)"),component:te}),r.a.createElement(i.b,{path:"".concat(e,"/*"),component:ne}))):r.a.createElement(i.a,{to:"/welcome"})},sidebar:!0},{path:"/settings",label:"Settings",exact:!0,icon:b.a,component:function(){return r.a.createElement(r.a.Fragment,null,r.a.createElement(Oe,null))},sidebar:!0},{path:"/about",label:"About",exact:!0,icon:v.a,component:function(){return r.a.createElement(r.a.Fragment,null,"about page")},sidebar:!0},{path:"/welcome",label:"Welcome",exact:!0,component:function(){var e=xe();return r.a.createElement(r.a.Fragment,null,r.a.createElement(we,null),r.a.createElement(R.a,{variant:"h3",className:e.text,noWrap:!0},"Welcome!"),r.a.createElement("div",{className:e.disclamer},r.a.createElement(R.a,{component:"h6"},"In order to get started, you need to configure the app to connect it with your server"),r.a.createElement(o.b,{to:"/settings",className:e.link},r.a.createElement(D.a,{variant:"outlined",color:"primary"},"Go To Settings"))))}},{path:"/*",component:ne}],Se=a(289),ye=a(288),Ne=a(287),Ce=a(295),Be=a(294),Fe=a(282),Le=a(284),Ue=a(285),Pe=a(286),Ie=a(163),We=a.n(Ie),Te=a(290),ze=a(20),Ae=Object(F.a)((function(e){var t;return Object(L.a)({root:{display:"flex"},drawer:Object(re.a)({},e.breakpoints.up("sm"),{width:240,flexShrink:0}),appBar:(t={},Object(re.a)(t,e.breakpoints.up("sm"),{width:"calc(100% - ".concat(240,"px)"),marginLeft:240}),Object(re.a)(t,"backgroundColor","#282c34"),t),menuButton:Object(re.a)({marginRight:e.spacing(2)},e.breakpoints.up("sm"),{display:"none"}),toolbar:e.mixins.toolbar,drawerPaper:{width:240},content:{flexGrow:1,padding:e.spacing(3)},navListLink:{textDecoration:"none"},navListItemText:{color:"#000"}})})),De=function(e){var t=e.label,a=e.path,n=e.divider,c=e.selected,l=e.onClick,i=e.icon,s=Ae();return r.a.createElement(o.b,{to:a,className:s.navListLink,onClick:l},r.a.createElement(Le.a,{divider:n,selected:c,button:!0},r.a.createElement(Ue.a,null,r.a.createElement(i,null)),r.a.createElement(Pe.a,{classes:{root:s.navListItemText},primary:t})))},Re=function(e){var t=e.children,a=Ae(),c=Object(ze.a)(),l=Object(i.g)(),s=Object(n.useState)(!1),u=Object(h.a)(s,2),m=u[0],p=u[1],d=function(){return p(!m)},b="Not Found",f=ke.find((function(e){return"/"!==e.path&&"/*"!==e.path?l.pathname.startsWith(e.path):e.path===l.pathname}));f&&f.label&&(b=f.label);var v=r.a.createElement("div",null,r.a.createElement("div",{className:a.toolbar},r.a.createElement(o.b,{to:"/",className:a.navListLink,onClick:function(){return p(!1)}},r.a.createElement(we,null))),r.a.createElement(Ne.a,null),r.a.createElement(Fe.a,null,ke.filter((function(e){return e.sidebar})).map((function(e){return r.a.createElement(De,{key:e.path,label:e.label,path:e.path,icon:e.icon,divider:e.divider,selected:!!Object(i.f)(l.pathname,{path:e.path,exact:e.exact}),onClick:function(){return p(!1)}})}))));return r.a.createElement("div",{className:a.root},r.a.createElement(ye.a,null),r.a.createElement(Se.a,{position:"fixed",className:a.appBar},r.a.createElement(Te.a,null,r.a.createElement(j.a,{color:"inherit","aria-label":"open drawer",edge:"start",onClick:d,className:a.menuButton},r.a.createElement(We.a,null)),r.a.createElement(R.a,{variant:"h6",noWrap:!0},b))),r.a.createElement("nav",{className:a.drawer,"aria-label":"mailbox folders"},r.a.createElement(Be.a,{smUp:!0,implementation:"css"},r.a.createElement(Ce.a,{variant:"temporary",anchor:"rtl"===c.direction?"right":"left",open:m,onClose:d,classes:{paper:a.drawerPaper},ModalProps:{keepMounted:!0}},v)),r.a.createElement(Be.a,{xsDown:!0,implementation:"css"},r.a.createElement(Ce.a,{classes:{paper:a.drawerPaper},variant:"permanent",open:!0},v))),r.a.createElement("main",{className:a.content},r.a.createElement("div",{className:a.toolbar}),t))},He=function(){return r.a.createElement(o.a,{basename:"/pi-home-web"},r.a.createElement(n.Suspense,{fallback:r.a.createElement("div",null,"Loading...")},r.a.createElement(Re,null,r.a.createElement(i.d,null,ke.map((function(e,t){return r.a.createElement(i.b,{key:t,path:e.path,exact:e.exact,component:e.component})}))))))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));l.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(He,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[175,1,2]]]);
//# sourceMappingURL=main.521de9a0.chunk.js.map